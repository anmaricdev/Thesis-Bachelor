<details style="border-radius: 5px; display: inline-block; max-width: 100%; width: 100%;">
    <summary style="cursor: pointer; font-size: 16px; display: inline-block; padding: 10px 15px; background-color: #ccc; border-radius: 5px;">Toggle Code</summary>
    <div style="background-color: #f0f0f0; border-radius: 5px; margin-top: 5px; padding: 10px; max-width: 100%; max-height: 50vh; width: fit-content; overflow: auto;">
<div class="highlight" style="background: #f0f0f0"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre style="line-height: 125%;">
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 1</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 2</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 3</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 4</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 5</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 6</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 7</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 8</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;"> 9</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">10</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">11</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">12</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">13</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">14</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">15</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">16</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">17</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">18</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">19</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">20</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">21</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">22</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">23</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">24</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">25</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">26</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">27</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">28</span>
<span style="color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px;">29</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><span style="color: #007020; font-weight: bold">def</span> <span style="color: #06287e">bin_packing_worst_fit_var_capa</span>(bin_capacities, elements):
  is_packing_possible <span style="color: #666666">=</span> <span style="color: #007020; font-weight: bold">True</span>
  max_capacity <span style="color: #666666">=</span> <span style="color: #007020">max</span>(bin_capacities)
  m <span style="color: #666666">=</span> <span style="color: #007020">len</span>(bin_capacities)
  n <span style="color: #666666">=</span> <span style="color: #007020">len</span>(elements)
  bins <span style="color: #666666">=</span> [[] <span style="color: #007020; font-weight: bold">for</span> _ <span style="color: #007020; font-weight: bold">in</span> <span style="color: #007020">range</span>(m)]
  bins_in_use <span style="color: #666666">=</span> [i <span style="color: #007020; font-weight: bold">for</span> i <span style="color: #007020; font-weight: bold">in</span> <span style="color: #007020">range</span>(m)]
  bins_packed_after_failure <span style="color: #666666">=</span> [[] <span style="color: #007020; font-weight: bold">for</span> _ <span style="color: #007020; font-weight: bold">in</span> <span style="color: #007020">range</span>(m)]
  <span style="color: #007020; font-weight: bold">for</span> elem <span style="color: #007020; font-weight: bold">in</span> elements:
    <span style="color: #60a0b0; font-style: italic"># search for bin in use where it fits worst</span>
    worst_bin <span style="color: #666666">=</span> <span style="color: #666666">-</span><span style="color: #40a070">1</span>
    worst_remaining_capacity <span style="color: #666666">=</span> <span style="color: #666666">-</span><span style="color: #40a070">1</span>
    <span style="color: #007020; font-weight: bold">for</span> i <span style="color: #007020; font-weight: bold">in</span> <span style="color: #007020">range</span>(<span style="color: #007020">len</span>(bins_in_use)):
      remaining_capacity <span style="color: #666666">=</span> bin_capacities[bins_in_use[i]
                                          ] <span style="color: #666666">-</span> (<span style="color: #007020">sum</span>(bins[bins_in_use[i]]) <span style="color: #666666">+</span> elem)
      <span style="color: #007020; font-weight: bold">if</span> remaining_capacity <span style="color: #666666">&gt;=</span> <span style="color: #40a070">0</span> <span style="color: #007020; font-weight: bold">and</span> remaining_capacity <span style="color: #666666">&gt;</span> worst_remaining_capacity:
        worst_bin <span style="color: #666666">=</span> bins_in_use[i]
        worst_remaining_capacity <span style="color: #666666">=</span> remaining_capacity
    <span style="color: #60a0b0; font-style: italic"># found?</span>
    <span style="color: #007020; font-weight: bold">if</span> worst_bin <span style="color: #666666">!=</span> <span style="color: #666666">-</span><span style="color: #40a070">1</span>:
      bins[worst_bin] <span style="color: #666666">+=</span> [elem]
      <span style="color: #007020; font-weight: bold">if</span> <span style="color: #007020; font-weight: bold">not</span> is_packing_possible:
        bins_packed_after_failure[worst_bin] <span style="color: #666666">+=</span> [elem]
      <span style="color: #60a0b0; font-style: italic"># is this bin full now?</span>
      <span style="color: #007020; font-weight: bold">if</span> worst_remaining_capacity <span style="color: #666666">==</span> <span style="color: #40a070">0</span>:
        bins_in_use<span style="color: #666666">.</span>remove(worst_bin)
    <span style="color: #007020; font-weight: bold">else</span>:
      is_packing_possible <span style="color: #666666">=</span> <span style="color: #007020; font-weight: bold">False</span>
  <span style="color: #007020; font-weight: bold">return</span> is_packing_possible, bins, bins_packed_after_failure
</pre></div></td></tr></table></div>
    </div>
</details>